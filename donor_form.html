<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register as Donor | LifeLink+</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
        
        /* Custom Focus Ring for Donor Theme */
        .focus-input:focus {
            border-color: #059669; /* Emerald-600 */
            box-shadow: 0 0 0 3px rgba(5, 150, 105, 0.1);
        }

        /* Smooth Card Hover */
        .form-section {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .form-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        /* Custom Checkbox Button Styling */
        .donation-checkbox:checked + div {
            background-color: #ecfdf5; /* Emerald-50 */
            border-color: #059669; /* Emerald-600 */
            color: #065f46; /* Emerald-800 */
        }
        .donation-checkbox:checked + div i {
            color: #059669;
        }
    </style>
</head>
<body class="bg-emerald-50 text-slate-800">

    <!-- NAVBAR -->
    <nav class="bg-white border-b border-emerald-100 sticky top-0 z-50">
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center gap-2">
                    <i class="fa-solid fa-heart-pulse text-red-600 text-2xl"></i>
                    <span class="font-bold text-xl tracking-tight text-slate-900">LifeLink+</span>
                </div>
                <a href="index.html" class="text-sm font-medium text-slate-500 hover:text-emerald-600 transition">
                    <i class="fa-solid fa-arrow-left mr-1"></i> Back to Home
                </a>
            </div>
        </div>
    </nav>

    <!-- HEADER -->
    <header class="bg-teal-900 text-white py-12 relative overflow-hidden">
        <!-- Decorative background blobs -->
        <div class="absolute top-0 left-0 -ml-10 -mt-10 w-40 h-40 bg-emerald-500 rounded-full opacity-20 blur-3xl"></div>
        <div class="absolute bottom-0 right-0 -mr-10 -mb-10 w-40 h-40 bg-teal-400 rounded-full opacity-20 blur-3xl"></div>

        <div class="max-w-4xl mx-auto px-6 text-center relative z-10">
            <div class="inline-flex items-center justify-center w-16 h-16 bg-teal-800 rounded-full mb-4 shadow-lg border border-teal-700">
                <i class="fa-solid fa-hand-holding-medical text-3xl text-emerald-400"></i>
            </div>
            <h1 class="text-3xl md:text-4xl font-bold mb-3">Register as a Donor</h1>
            <p class="text-teal-100 text-lg max-w-2xl mx-auto">Join our verified platelet & rare-blood emergency network. Be the lifeline someone needs today.</p>
        </div>
    </header>

    <!-- MAIN FORM -->
    <main class="max-w-4xl mx-auto px-6 py-10 -mt-8 relative z-20">
        <form id="donorForm" onsubmit="handleRegistration(event)" class="space-y-8">

            <!-- SECTION 1: PERSONAL IDENTITY -->
            <section class="bg-white p-8 rounded-2xl shadow-sm border border-emerald-100 form-section">
                <h2 class="text-lg font-bold text-slate-800 mb-6 flex items-center gap-3 border-b border-slate-100 pb-4">
                    <span class="flex items-center justify-center w-8 h-8 rounded-full bg-emerald-100 text-emerald-600 text-sm font-bold">1</span>
                    Personal Identity
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="md:col-span-2">
                        <label class="block text-sm font-bold text-slate-700 mb-2">Full Name <span class="text-red-500">*</span></label>
                        <input type="text" id="fullName" required placeholder="As per Aadhaar Card" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-xl outline-none focus-input transition">
                    </div>

                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">Date of Birth <span class="text-red-500">*</span></label>
                        <input type="date" id="dob" required onchange="calculateAge()" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-xl outline-none focus-input transition">
                    </div>

                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">Age</label>
                        <input type="text" id="age" readonly placeholder="Auto-calculated" class="w-full p-3 bg-gray-100 border border-slate-300 rounded-xl text-slate-500 font-mono cursor-not-allowed">
                    </div>

                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">Gender <span class="text-red-500">*</span></label>
                        <select id="gender" required class="w-full p-3 bg-slate-50 border border-slate-300 rounded-xl outline-none focus-input transition">
                            <option value="">Select Gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
            </section>

            <!-- SECTION 2: CONTACT & LOCATION -->
            <section class="bg-white p-8 rounded-2xl shadow-sm border border-emerald-100 form-section">
                <h2 class="text-lg font-bold text-slate-800 mb-6 flex items-center gap-3 border-b border-slate-100 pb-4">
                    <span class="flex items-center justify-center w-8 h-8 rounded-full bg-emerald-100 text-emerald-600 text-sm font-bold">2</span>
                    Contact & Location
                </h2>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">Mobile Number <span class="text-red-500">*</span></label>
                        <input type="tel" id="mobile" required pattern="[0-9]{10}" placeholder="10 Digit Mobile" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-xl outline-none focus-input transition">
                    </div>

                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">Email Address <span class="text-red-500">*</span></label>
                        <input type="email" id="email" required placeholder="you@example.com" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-xl outline-none focus-input transition">
                        <p class="hidden text-xs text-red-500 mt-1" id="emailError">Invalid email format.</p>
                    </div>

                    <div class="md:col-span-2">
                        <label class="block text-sm font-bold text-slate-700 mb-2">Address Line 1 <span class="text-red-500">*</span></label>
                        <input type="text" id="addr1" required placeholder="House No, Building, Street" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-xl outline-none focus-input transition">
                    </div>

                    <div class="md:col-span-2">
                        <label class="block text-sm font-bold text-slate-700 mb-2">Address Line 2 <span class="text-slate-400 font-normal">(Optional)</span></label>
                        <input type="text" id="addr2" placeholder="Area, Landmark" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-xl outline-none focus-input transition">
                    </div>

                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">City <span class="text-red-500">*</span></label>
                        <select id="city" required class="w-full p-3 bg-slate-50 border border-slate-300 rounded-xl outline-none focus-input transition">
                            <option value="">Select City</option>
                            <option value="Bangalore">Bengaluru</option>
                            <option value="Mumbai">Mumbai</option>
                            <option value="Delhi">Delhi</option>
                            <option value="Chennai">Chennai</option>
                            <option value="Hyderabad">Hyderabad</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">State <span class="text-red-500">*</span></label>
                        <select id="state" required class="w-full p-3 bg-slate-50 border border-slate-300 rounded-xl outline-none focus-input transition">
                            <option value="">Select State</option>
                            <option value="Karnataka">Karnataka</option>
                            <option value="Maharashtra">Maharashtra</option>
                            <option value="Delhi">Delhi</option>
                            <option value="Tamil Nadu">Tamil Nadu</option>
                            <option value="Telangana">Telangana</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">PIN Code <span class="text-red-500">*</span></label>
                        <input type="text" id="pincode" required pattern="[0-9]{6}" maxlength="6" placeholder="6 Digit PIN" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-xl outline-none focus-input transition">
                        <p class="hidden text-xs text-red-500 mt-1" id="pinError">Must be 6 digits.</p>
                    </div>
                </div>
            </section>

            <!-- SECTION 3: DONATION PROFILE -->
            <section class="bg-white p-8 rounded-2xl shadow-sm border border-emerald-100 form-section">
                <h2 class="text-lg font-bold text-slate-800 mb-6 flex items-center gap-3 border-b border-slate-100 pb-4">
                    <span class="flex items-center justify-center w-8 h-8 rounded-full bg-emerald-100 text-emerald-600 text-sm font-bold">3</span>
                    Medical & Donation Profile
                </h2>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">Blood Group <span class="text-red-500">*</span></label>
                        <select id="bloodGroup" required class="w-full p-3 bg-slate-50 border border-slate-300 rounded-xl outline-none focus-input transition font-bold text-slate-700">
                            <option value="">Select Group</option>
                            <option value="A+">A+</option><option value="A-">A-</option>
                            <option value="B+">B+</option><option value="B-">B-</option>
                            <option value="O+">O+</option><option value="O-">O-</option>
                            <option value="AB+">AB+</option><option value="AB-">AB-</option>
                            <option value="Oh">Bombay Blood Group (Oh)</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">Last Donation Date</label>
                        <input type="date" id="lastDonation" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-xl outline-none focus-input transition">
                        <p class="text-xs text-slate-400 mt-1">Leave blank if you have never donated.</p>
                    </div>
                </div>

                <div class="mb-2">
                    <label class="block text-sm font-bold text-slate-700 mb-3">Willing to Donate <span class="text-red-500">*</span> <span class="text-xs font-normal text-slate-500">(Select all that apply)</span></label>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <label class="cursor-pointer relative">
                            <input type="checkbox" class="peer sr-only donation-checkbox" value="Whole Blood">
                            <div class="p-4 rounded-xl border border-slate-200 text-center hover:bg-emerald-50 transition h-full flex flex-col items-center justify-center gap-2">
                                <i class="fa-solid fa-droplet text-slate-300 text-2xl"></i>
                                <span class="font-bold text-slate-700">Whole Blood</span>
                                <span class="text-xs text-slate-400">Standard Donation</span>
                            </div>
                        </label>
                        <label class="cursor-pointer relative">
                            <input type="checkbox" class="peer sr-only donation-checkbox" value="Platelets">
                            <div class="p-4 rounded-xl border border-slate-200 text-center hover:bg-emerald-50 transition h-full flex flex-col items-center justify-center gap-2">
                                <i class="fa-solid fa-layer-group text-slate-300 text-2xl"></i>
                                <span class="font-bold text-slate-700">Platelets (SDP)</span>
                                <span class="text-xs text-slate-400">High Priority</span>
                            </div>
                        </label>
                        <label class="cursor-pointer relative">
                            <input type="checkbox" class="peer sr-only donation-checkbox" value="Stem Cells">
                            <div class="p-4 rounded-xl border border-slate-200 text-center hover:bg-emerald-50 transition h-full flex flex-col items-center justify-center gap-2">
                                <i class="fa-solid fa-dna text-slate-300 text-2xl"></i>
                                <span class="font-bold text-slate-700">Stem Cells</span>
                                <span class="text-xs text-slate-400">For Leukemia Matches</span>
                            </div>
                        </label>
                    </div>
                </div>
            </section>

            <!-- SECTION 4: VERIFICATION -->
            <section class="bg-white p-8 rounded-2xl shadow-sm border border-emerald-100 form-section">
                <h2 class="text-lg font-bold text-slate-800 mb-6 flex items-center gap-3 border-b border-slate-100 pb-4">
                    <span class="flex items-center justify-center w-8 h-8 rounded-full bg-emerald-100 text-emerald-600 text-sm font-bold">4</span>
                    Identity Verification
                </h2>

                <div class="grid grid-cols-1 gap-6">
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">Upload Masked Aadhaar <span class="text-red-500">*</span></label>
                        <div class="relative border-2 border-dashed border-slate-300 rounded-xl p-6 text-center hover:bg-slate-50 transition group">
                            <input type="file" id="aadhaarDoc" required accept=".pdf,.jpg,.jpeg,.png" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer" onchange="updateFileName()">
                            <div class="space-y-2 pointer-events-none">
                                <i class="fa-solid fa-cloud-arrow-up text-3xl text-slate-400 group-hover:text-emerald-500 transition"></i>
                                <p id="fileNameDisplay" class="text-sm text-slate-600 font-medium">Click to upload PDF, JPG or PNG</p>
                                <p class="text-xs text-slate-400">Max size: 2MB</p>
                            </div>
                        </div>
                        <div class="mt-3 flex items-start gap-2 bg-yellow-50 p-3 rounded-lg text-yellow-800 text-xs">
                            <i class="fa-solid fa-shield-halved mt-0.5"></i>
                            <p><strong>Security Notice:</strong> Please upload a <strong>Masked Aadhaar</strong> only. The first 8 digits should be hidden/crossed out, and only the last 4 digits should be visible.</p>
                        </div>
                    </div>

                    <label class="flex items-start gap-3 cursor-pointer">
                        <input type="checkbox" required class="w-5 h-5 text-emerald-600 border-slate-300 rounded focus:ring-emerald-500 mt-0.5">
                        <span class="text-sm text-slate-600">I consent to using my Masked Aadhaar for identity verification purposes on LifeLink+.</span>
                    </label>
                </div>
            </section>

            <!-- SECTION 5: ACCOUNT SECURITY -->
            <section class="bg-white p-8 rounded-2xl shadow-sm border border-emerald-100 form-section">
                <h2 class="text-lg font-bold text-slate-800 mb-6 flex items-center gap-3 border-b border-slate-100 pb-4">
                    <span class="flex items-center justify-center w-8 h-8 rounded-full bg-emerald-100 text-emerald-600 text-sm font-bold">5</span>
                    Account Access
                </h2>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="md:col-span-2">
                        <label class="block text-sm font-bold text-slate-700 mb-2">Username <span class="text-red-500">*</span></label>
                        <input type="text" id="username" required placeholder="Create a unique username" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-xl outline-none focus-input transition">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">Password <span class="text-red-500">*</span></label>
                        <input type="password" id="password" required class="w-full p-3 bg-slate-50 border border-slate-300 rounded-xl outline-none focus-input transition">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">Confirm Password <span class="text-red-500">*</span></label>
                        <input type="password" id="confirmPassword" required class="w-full p-3 bg-slate-50 border border-slate-300 rounded-xl outline-none focus-input transition">
                        <p class="hidden text-xs text-red-500 mt-1" id="passError">Passwords do not match.</p>
                    </div>
                </div>

                <div class="border-t border-slate-100 mt-8 pt-6 space-y-4">
                    <label class="flex items-start gap-3 cursor-pointer">
                        <input type="checkbox" checked class="w-5 h-5 text-emerald-600 border-slate-300 rounded focus:ring-emerald-500 mt-0.5">
                        <span class="text-sm text-slate-600">I agree to receive urgent donation alerts and notifications via SMS/Email.</span>
                    </label>

                    <label class="flex items-start gap-3 cursor-pointer">
                        <input type="checkbox" required class="w-5 h-5 text-emerald-600 border-slate-300 rounded focus:ring-emerald-500 mt-0.5">
                        <span class="text-sm text-slate-600">I agree to the <a href="#" class="text-emerald-600 underline font-medium">Terms & Conditions</a> and confirm that I am medically fit to donate.</span>
                    </label>

                    <button type="submit" id="submitBtn" class="w-full bg-teal-900 text-white font-bold text-lg py-4 rounded-xl shadow-lg hover:bg-teal-800 transition transform active:scale-[0.99] flex justify-center items-center gap-3 mt-4">
                        <span>Register as Donor</span>
                        <i class="fa-solid fa-heart"></i>
                    </button>
                </div>
            </section>

        </form>
    </main>

    <!-- FOOTER -->
    <footer class="bg-white border-t border-emerald-100 py-8 mt-12 text-center">
        <p class="text-sm text-slate-500">Already registered? <a href="login_form_donor.html" class="text-emerald-600 font-bold hover:underline">Login here</a></p>
        <p class="text-xs text-slate-400 mt-2">Â© 2025 LifeLink+ Donor Network</p>
    </footer>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // Calculate Age from DOB
        function calculateAge() {
            const dobInput = document.getElementById('dob').value;
            if(dobInput) {
                const dob = new Date(dobInput);
                const diff_ms = Date.now() - dob.getTime();
                const age_dt = new Date(diff_ms); 
                const age = Math.abs(age_dt.getUTCFullYear() - 1970);
                document.getElementById('age').value = age + " Years";
            }
        }

        // Update File Name Display
        function updateFileName() {
            const input = document.getElementById('aadhaarDoc');
            const display = document.getElementById('fileNameDisplay');
            if(input.files && input.files[0]) {
                display.innerText = input.files[0].name;
                display.classList.add('text-emerald-600', 'font-bold');
            }
        }

        // Handle Form Submission
        function handleRegistration(event) {
            event.preventDefault();

            // --- DOM Elements ---
            const password = document.getElementById('password');
            const confirmPassword = document.getElementById('confirmPassword');
            const passError = document.getElementById('passError');
            const pincode = document.getElementById('pincode');
            const pinError = document.getElementById('pinError');
            const email = document.getElementById('email');
            const emailError = document.getElementById('emailError');
            const fileInput = document.getElementById('aadhaarDoc');
            const submitBtn = document.getElementById('submitBtn');

            let isValid = true;

            // 1. Password Validation
            if (password.value !== confirmPassword.value) {
                passError.classList.remove('hidden');
                confirmPassword.classList.add('border-red-500');
                isValid = false;
            } else {
                passError.classList.add('hidden');
                confirmPassword.classList.remove('border-red-500');
            }

            // 2. PIN Code Validation
            if (!/^\d{6}$/.test(pincode.value)) {
                pinError.classList.remove('hidden');
                pincode.classList.add('border-red-500');
                isValid = false;
            } else {
                pinError.classList.add('hidden');
                pincode.classList.remove('border-red-500');
            }

            // 3. Email Validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email.value)) {
                emailError.classList.remove('hidden');
                email.classList.add('border-red-500');
                isValid = false;
            } else {
                emailError.classList.add('hidden');
                email.classList.remove('border-red-500');
            }

            // 4. File Validation (Size check example - 2MB)
            if (fileInput.files[0] && fileInput.files[0].size > 2 * 1024 * 1024) {
                alert("File size exceeds 2MB limit.");
                isValid = false;
            }

            if (!isValid) return;

            // 5. Collect Data
            const selectedWillingness = Array.from(document.querySelectorAll('.donation-checkbox:checked')).map(cb => cb.value);

            const formData = {
                fullName: document.getElementById('fullName').value,
                dob: document.getElementById('dob').value,
                age: document.getElementById('age').value,
                gender: document.getElementById('gender').value,
                mobile: document.getElementById('mobile').value,
                email: email.value,
                address: {
                    line1: document.getElementById('addr1').value,
                    line2: document.getElementById('addr2').value,
                    city: document.getElementById('city').value,
                    state: document.getElementById('state').value,
                    pincode: pincode.value
                },
                bloodGroup: document.getElementById('bloodGroup').value,
                willingToDonate: selectedWillingness,
                lastDonation: document.getElementById('lastDonation').value,
                username: document.getElementById('username').value,
                // Note: Passwords should be hashed or sent securely
            };

            console.log("Donor Registration Data:", formData);

            // UI Feedback
            const originalBtnText = submitBtn.innerHTML;
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i> Processing...';

            // --- API CALL ---
            // // TODO: POST form data to '/api/registerDonor'
            // const formDataObj = new FormData();
            // formDataObj.append('data', JSON.stringify(formData));
            // formDataObj.append('aadhaarDoc', fileInput.files[0]);
            //
            // fetch('/api/registerDonor', {
            //     method: 'POST',
            //     body: formDataObj
            // }).then(response => ...)

            // Simulate Success
            setTimeout(() => {
                alert("Registration Successful! You are now part of the LifeLink+ Network.");
                submitBtn.innerHTML = originalBtnText;
                submitBtn.disabled = false;
                // window.location.href = '/login';
            }, 2000);
        }
    </script>
</body>
</html>